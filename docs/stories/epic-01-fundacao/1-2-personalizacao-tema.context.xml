<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.2</storyId>
    <title>Personalização da Identidade Visual (Tema)</title>
    <status>drafted</status>
    <generatedAt>2025-11-07</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/epic-01-fundacao/story-1.2-personalizacao-tema.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>um gestor de conteúdo</asA>
    <iWant>que o site tenha a identidade visual da Secretaria de Saúde</iWant>
    <soThat>os usuários reconheçam imediatamente a origem oficial do conteúdo</soThat>
    <tasks>
      - 1.2.1: Definir Paleta de Cores e Tipografia
      - 1.2.2: Instalar e Configurar shadcn studio pro (Base de Componentes)
      - 1.2.3: Configurar CSS Customizado
      - 1.2.4: Configurar Fontes Customizadas
      - 1.2.5: Substituir Logo
      - 1.2.6: Validar Alterações
    </tasks>
  </story>

  <acceptanceCriteria>
    - AC1: Paleta de cores e tipografia da Secretaria aplicadas
    - AC2: Shadcn studio pro instalado e configurado
    - AC3: Componentes base shadcn instalados e testados
    - AC4: CSS customizado aplicado com variáveis do Starlight
    - AC5: Fontes customizadas configuradas
    - AC6: Logo oficial substituído
    - AC7: Tema consistente em todo o site
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/Arquitetura.md</path>
        <title>Documento de Arquitetura Fullstack</title>
        <section>3.5. Estratégia de Componentização com shadcn studio pro</section>
        <snippet>Todos os componentes UI personalizados serão construídos usando shadcn studio pro como biblioteca base (shadcn-astro latest). Sistema de design unificado com lucide-react para ícones. Shadcn Studio MCP Server disponível para auxiliar desenvolvimento.</snippet>
      </doc>
      <doc>
        <path>docs/Arquitetura.md</path>
        <title>Documento de Arquitetura Fullstack</title>
        <section>Tech Stack v2.0</section>
        <snippet>Astro ^5.x + Starlight (latest) com TypeScript ^5.x e Tailwind CSS ^4.x. shadcn-astro (latest) como base para TODOS componentes personalizados. Gerenciador: pnpm.</snippet>
      </doc>
      <doc>
        <path>docs/tech-spec-epic-01.md</path>
        <title>Epic 1 Technical Specification: Fundação da Plataforma</title>
        <section>Scope - Story 1.2</section>
        <snippet>Visual identity customization including color palette, typography, and shadcn studio pro component library integration. Document metadata display components using shadcn Cards, Badges, and Alerts for subsequent stories.</snippet>
      </doc>
      <doc>
        <path>docs/PR.md</path>
        <title>PRD: Base de Conhecimento da Saúde</title>
        <section>História 1.2 - Personalização da Identidade Visual</section>
        <snippet>Aplicar identidade visual da Secretaria de Saúde com cores institucionais, tipografia adequada, e logo oficial. Garantir reconhecimento imediato pelos profissionais de saúde.</snippet>
      </doc>
      <doc>
        <path>docs/stories/epic-01-fundacao/story-1.1-configuracao-inicial.md</path>
        <title>Story 1.1: Configuração Inicial do Projeto</title>
        <section>Completion Notes</section>
        <snippet>Foundation completed: Astro v5.15.4 + Starlight template initialized, Node.js v22 LTS + pnpm v10.20.0, Git repository ready. Clean base ready for theme customization.</snippet>
      </doc>
    </docs>
    <code>
      <file>
        <path>astro.config.mjs</path>
        <kind>configuration</kind>
        <symbol>starlight config</symbol>
        <lines>all</lines>
        <reason>Starlight configuration where customCss, logo, and theme settings will be applied. Current title already customized.</reason>
      </file>
      <file>
        <path>src/content/docs/index.mdx</path>
        <kind>content</kind>
        <symbol>homepage</symbol>
        <lines>all</lines>
        <reason>Homepage using splash template where theme will be visible. Will serve as validation point for visual changes.</reason>
      </file>
      <file>
        <path>package.json</path>
        <kind>dependencies</kind>
        <symbol>dependencies</symbol>
        <lines>12-16</lines>
        <reason>Current dependencies: @astrojs/starlight ^0.36.2, astro ^5.6.1, sharp ^0.34.2. Will need to add shadcn-astro, tailwindcss, and related packages.</reason>
      </file>
    </code>
    <dependencies>
      <astro>
        <version>^5.6.1</version>
        <note>Current version, compatible with Starlight</note>
      </astro>
      <starlight>
        <package>@astrojs/starlight</package>
        <version>^0.36.2</version>
        <note>Documentation framework currently installed</note>
      </starlight>
      <shadcn-required>
        <note>Need to install: shadcn-astro (latest), tailwindcss (^4.x), lucide-react (latest) for icons</note>
        <reference>https://shadcnstudio.com/docs/getting-started/how-to-use-shadcn-cli</reference>
      </shadcn-required>
      <components-to-install>
        <note>Base components: Button, Card, Badge, Alert, Input, Avatar, DropdownMenu, Separator per story requirements</note>
      </components-to-install>
    </dependencies>
  </artifacts>

  <constraints>
    - Use pnpm as package manager (not npm) throughout the project
    - Maintain compatibility with existing Astro v5.x and Starlight configuration
    - Follow shadcn studio pro setup guide for Astro integration
    - Ensure WCAG 2.1 AA compliance for color contrast (per story notes)
    - Keep design tokens consistent between Starlight and shadcn systems
    - Create test page /test-components for component validation (can be removed after)
    - All CSS customization must use Starlight's CSS variable system (--sl-color-*, --sl-font-*)
    - Logo should be SVG format and placed in public/ directory
    - Must maintain existing project structure from Story 1.1
  </constraints>

  <interfaces>
    <starlight-customization>
      <kind>configuration</kind>
      <signature>astro.config.mjs → starlight({ customCss: ['src/assets/custom.css'], logo: { src: './public/logo.svg' } })</signature>
      <path>astro.config.mjs</path>
      <note>Starlight configuration interface for custom styling and logo</note>
    </starlight-customization>
    <css-variables>
      <kind>theming</kind>
      <signature>CSS variables: --sl-color-accent, --sl-color-accent-low, --sl-font-body, --sl-font-headings</signature>
      <path>src/assets/custom.css (to be created)</path>
      <note>Starlight's CSS variable system for theme customization</note>
    </css-variables>
  </interfaces>

  <tests>
    <standards>This is a visual/UI customization story with manual validation. No automated tests required initially. Validation done through: (1) visual inspection of theme across site pages, (2) test components page rendering correctly, (3) contrast checker for WCAG compliance, (4) dev server live reload verification.</standards>
    <locations>
      - Test page: src/content/docs/test-components.mdx (create for validation, remove after)
      - Manual testing: Browse localhost after changes
    </locations>
    <ideas>
      - AC1: Verify custom colors applied via browser DevTools inspection of CSS variables
      - AC2: Verify shadcn CLI installation with `npx shadcn` command
      - AC3: Test each installed component renders on /test-components page
      - AC4: Inspect --sl-color-* variables in custom.css are overriding defaults
      - AC5: Verify custom fonts loading in browser Network tab
      - AC6: Verify logo displays in site header and has correct dimensions
      - AC7: Navigate multiple pages to confirm consistent theme application
      - WCAG: Use browser extension or online tool to verify color contrast meets AA standard
    </ideas>
  </tests>
</story-context>
